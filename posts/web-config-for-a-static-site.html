
<!DOCTYPE html>
<html lang="en">
        <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>

        <title>Andy Hansen - Web.config for a Static Site</title>
        <meta name="description" content="Andy Hansen&#x27;s Blog" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">        

        <link type="application/rss+xml" rel="alternate" title="Andy Hansen" href="/feed.rss" />
                <link type="application/atom+xml" rel="alternate" title="Andy Hansen" href="/feed.atom" />
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/favicon.ico" type="image/x-icon">

        <link href="/assets/css/bootstrap.min.css" rel="stylesheet" />
        <link href="/assets/css/highlight.css" rel="stylesheet">
        <link href="/assets/css/clean-blog.css" rel="stylesheet" />
        <link href="/assets/css/master.css" rel="stylesheet" />
        <link href="/assets/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
        <link href="/assets/css/override.css" rel="stylesheet" />


        <meta name="application-name" content="Andy Hansen" />
        <meta name="msapplication-tooltip" content="Andy Hansen" />
        <meta name="msapplication-starturl" content="/" />

        <meta property="og:title" content="Andy Hansen - Web.config for a Static Site" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="http://andyhansen.co.nz/posts/web-config-for-a-static-site" />
        <!-- TODO: More social graph meta tags -->

        <script src="/assets/js/jquery.min.js"></script>
        <script src="/assets/js/bootstrap.min.js"></script>     
        <script src="/assets/js/highlight.pack.js"></script>   
        <script src="/assets/js/clean-blog.js"></script>
        <script src="/assets/js/d3.v3.min.js"></script>
        <script src="/assets/js/trianglify.min.js"></script>
        <script src="/assets/js/Please-compressed.js"></script>
        <script src="/assets/js/background-check.min.js"></script>
                
        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
                <script src="/assets/js/html5shiv.js"></script>
                <script src="/assets/js/respond.min.js"></script>
        <![endif]-->
        
        


        </head>
        <body>
                
                <!-- Navigation -->
                <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
                        <div class="container-fluid">
                                <!-- Brand and toggle get grouped for better mobile display -->
                                <div class="navbar-header page-scroll">
                                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse">
                                        <span class="sr-only">Toggle navigation</span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                        </button>
                                        <a class="navbar-brand" href="/">Andy Hansen</a>
                                </div>
                        
                                <!-- Collect the nav links, forms, and other content for toggling -->
                                <div class="collapse navbar-collapse" id="navbar-collapse">
                                        <ul class="nav navbar-nav navbar-right">
                                                <li><a href="/about">About</a></li>
<li><a href="/posts">Archive</a></li>
<li><a href="/tags">Tags</a></li> 
                                        </ul>
                                </div>
                                <!-- /.navbar-collapse -->
                        </div>
                        <!-- /.container -->
                </nav>
                
                <!-- Page Header -->
                <header class="intro-header" id="intro-header" style="background-image: url(&quot;/images/headers/forrest-cavale-13484.jpg&quot;)">
                        <div class="container">
                                <div class="row">
                                        <div class="col-md-12">

    
<div class="post-heading">
    <h1>Web.config for a Static Site</h1>
    <div class="meta">        
            <span>Published on Sunday, 12 February 2017<br></span>
        <div class="read-time hide">
            <span class="time-to-read"></span> (<span class="word-count"></span> words)
        </div>
    </div>
        <div class="tags">
                    <a role="button" href="/tags/IIS" class="btn btn-default btn-xs">IIS</a>
                    <a role="button" href="/tags/Wyam" class="btn btn-default btn-xs">Wyam</a>
        </div>     
</div>
                                        </div>
                                </div>
                        </div>
                </header>
                
                <!-- Main Content -->
                <div class="container">
                        <div class="row">
                                <div id="content" class="col-md-12">
                                        

<p>When I originally set up this blog, I was using a very basic web.config.
I quickly found this wasn't complete enough for my needs, so gave it a bit of an upgrade.</p>
<p>In this post I'll go through my the sections of my web.config and explain why they are necessary.
At the bottom of the post you will find the config in full, so you can copy it for your own static site.
I can only confirm that this config works with my Wyam site on Azure, but it should work with any other IIS hosted static site.</p>
<h2 id="web.config-sections">Web.config sections</h2>
<p>Here I'll go through the sections of my web.config, what they do, and why I'm using them.</p>
<h3 id="error-handling">Error handling</h3>
<p>I have a couple of error redirects so that the user isn't given a blank page when something goes wrong.
These pages cover 404 (page not found), and 500 (server) errors.
If either of these errors occur, the user will be redirected to the specified error pages I've created so that they know what has gone wrong.
In my case, the error pages are named 404.html and 500.html, but you can name yours whatever you like by changing the path.</p>
<pre><code>&lt;httpErrors errorMode=&quot;Custom&quot;&gt;
    &lt;remove statusCode=&quot;500&quot; subStatusCode=&quot;-1&quot; /&gt;
    &lt;remove statusCode=&quot;404&quot; subStatusCode=&quot;-1&quot; /&gt;
    &lt;error statusCode=&quot;404&quot; prefixLanguageFilePath=&quot;&quot; path=&quot;/404.html&quot; responseMode=&quot;ExecuteURL&quot; /&gt;
    &lt;error statusCode=&quot;500&quot; prefixLanguageFilePath=&quot;&quot; path=&quot;/500.html&quot; responseMode=&quot;ExecuteURL&quot; /&gt;
    &lt;error statusCode=&quot;500&quot; subStatusCode=&quot;100&quot; path=&quot;/500.html&quot; responseMode=&quot;ExecuteURL&quot; /&gt;
&lt;/httpErrors&gt;
</code></pre>
<h3 id="routing-rules">Routing rules</h3>
<p>I've got a rule set up to remove the .html from the end of the URL, making it look cleaner.</p>
<pre><code>&lt;rule name=&quot;RewriteHtml&quot;&gt;
    &lt;match url=&quot;^(.*)$&quot; /&gt;
    &lt;conditions logicalGrouping=&quot;MatchAll&quot;&gt;
        &lt;add input=&quot;{REMOTE_PORT}&quot; pattern=&quot;.*&quot; /&gt;
        &lt;add input=&quot;{REQUEST_FILENAME}&quot; matchType=&quot;IsFile&quot; negate=&quot;true&quot; /&gt;
        &lt;add input=&quot;{REQUEST_FILENAME}&quot; matchType=&quot;IsDirectory&quot; negate=&quot;true&quot; /&gt;
    &lt;/conditions&gt;
    &lt;action type=&quot;Rewrite&quot; url=&quot;{R:1}.html&quot; /&gt;
&lt;/rule&gt;
</code></pre>
<p>This rule will remove the &quot;www.&quot; from the URLs.
You won't break anything if you don't include this rule, so you can skip it if you prefer the default behaviour.
I'm removing them on my site because I like to keep the URLs as short as possible.</p>
<pre><code>&lt;rule name=&quot;Remove WWW&quot; stopProcessing=&quot;true&quot;&gt;
    &lt;match url=&quot;(.*)&quot; ignoreCase=&quot;true&quot; /&gt;
    &lt;conditions logicalGrouping=&quot;MatchAll&quot;&gt;
        &lt;add input=&quot;{HTTP_HOST}&quot; pattern=&quot;^www\.(.+)$&quot; /&gt;
    &lt;/conditions&gt;
    &lt;action type=&quot;Redirect&quot; url=&quot;http://{C:1}/{R:0}&quot; appendQueryString=&quot;true&quot; redirectType=&quot;Permanent&quot; /&gt;
&lt;/rule&gt;
</code></pre>
<p>If you DON'T have SSL set up, then need to make sure you don't include this rule.
Though this rule is a must if you are using SSL, because it will ensure that the user is always viewing the secure version of your site.</p>
<p>SSL is not as necessary for static sites, because no user data is being transferred between your servers and your users.
However, it is best practice to have it set up, and it will help with your <a href="https://en.wikipedia.org/wiki/Search_engine_optimization">Search Engine Optimization</a>.
If you are interested in setting up SSL, you can get a certificate for free via <a href="https://letsencrypt.org/">Let's Encrypt</a>.</p>
<pre><code>&lt;rule name=&quot;Redirect to HTTPS&quot; stopProcessing=&quot;true&quot;&gt;
    &lt;match url=&quot;(.*)&quot; /&gt;
    &lt;conditions&gt;
        &lt;add input=&quot;{REMOTE_PORT}&quot; pattern=&quot;.*&quot; /&gt;
        &lt;add input=&quot;{HTTPS}&quot; pattern=&quot;^OFF$&quot; /&gt;
    &lt;/conditions&gt;
    &lt;action type=&quot;Redirect&quot; url=&quot;https://{HTTP_HOST}/{R:1}&quot; redirectType=&quot;Permanent&quot; /&gt;
&lt;/rule&gt;
</code></pre>
<h3 id="static-content-file-types">Static content file types</h3>
<p>Static content was the most important section I was missing in my original web.config.
It tells ISS what the content type is for file extensions it doesn't recognize.
Before it was set up, the browser couldn't open the RSS feed for my site, and some of my font files weren't loading.
IIS didn't recognize the file extensions, so served up the files with the incorrect file type of &quot;application&quot;.
So for each extension IIS doesn't know, we tell it what the file type is.</p>
<p>As you can see below, each extension is defined using the same pattern.
We tell IIS to forget everything it knows about a particular file extension, and then we tell it what the file type should be.
I've got a bit of future proofing in my web.config, so you may want to only include extensions you are using now.
I didn't see the harm of adding more now, I don't want to edit my web.config each time I use a new file type on my blog.</p>
<pre><code>&lt;staticContent&gt;
    &lt;remove fileExtension=&quot;.mp4&quot; /&gt;
    &lt;mimeMap fileExtension=&quot;.mp4&quot; mimeType=&quot;video/mp4&quot; /&gt;
    &lt;remove fileExtension=&quot;.m4v&quot; /&gt;
    &lt;mimeMap fileExtension=&quot;.m4v&quot; mimeType=&quot;video/m4v&quot; /&gt;
    &lt;remove fileExtension=&quot;.ogg&quot; /&gt;
    &lt;mimeMap fileExtension=&quot;.ogg&quot; mimeType=&quot;video/ogg&quot; /&gt;
    &lt;remove fileExtension=&quot;.ogv&quot; /&gt;
    &lt;mimeMap fileExtension=&quot;.ogv&quot; mimeType=&quot;video/ogg&quot; /&gt;
    &lt;remove fileExtension=&quot;.webm&quot; /&gt;
    &lt;mimeMap fileExtension=&quot;.webm&quot; mimeType=&quot;video/webm&quot; /&gt;
    &lt;remove fileExtension=&quot;.oga&quot; /&gt;
    &lt;mimeMap fileExtension=&quot;.oga&quot; mimeType=&quot;audio/ogg&quot; /&gt;
    &lt;remove fileExtension=&quot;.spx&quot; /&gt;
    &lt;mimeMap fileExtension=&quot;.spx&quot; mimeType=&quot;audio/ogg&quot; /&gt;
    &lt;remove fileExtension=&quot;.svg&quot; /&gt;
    &lt;mimeMap fileExtension=&quot;.svg&quot; mimeType=&quot;image/svg+xml&quot; /&gt;
    &lt;remove fileExtension=&quot;.svgz&quot; /&gt;
    &lt;mimeMap fileExtension=&quot;.svgz&quot; mimeType=&quot;image/svg+xml&quot; /&gt;

    &lt;!-- fonts --&gt;
    &lt;remove fileExtension=&quot;.otf&quot; /&gt;
    &lt;mimeMap fileExtension=&quot;.otf&quot; mimeType=&quot;font/otf&quot; /&gt;
    &lt;remove fileExtension=&quot;.eot&quot; /&gt;
    &lt;mimeMap fileExtension=&quot;.eot&quot; mimeType=&quot;application/vnd.ms-fontobject&quot; /&gt;
    &lt;remove fileExtension=&quot;.ttf&quot; /&gt;
    &lt;mimeMap fileExtension=&quot;.ttf&quot; mimeType=&quot;application/octet-stream&quot; /&gt;
    &lt;remove fileExtension=&quot;.woff&quot; /&gt;
    &lt;mimeMap fileExtension=&quot;.woff&quot; mimeType=&quot;application/font-woff&quot; /&gt;
    &lt;remove fileExtension=&quot;.woff2&quot; /&gt;
    &lt;mimeMap fileExtension=&quot;.woff2&quot; mimeType=&quot;application/font-woff2&quot; /&gt;

    &lt;!-- feeds --&gt;
    &lt;remove fileExtension=&quot;.rss&quot; /&gt;
    &lt;mimeMap fileExtension=&quot;.rss&quot; mimeType=&quot;application/rss+xml&quot; /&gt;
    &lt;remove fileExtension=&quot;.atom&quot; /&gt;
    &lt;mimeMap fileExtension=&quot;.atom&quot; mimeType=&quot;application/atom+xml&quot; /&gt;
&lt;/staticContent&gt;
</code></pre>
<h2 id="full-web.config">Full web.config</h2>
<p>So there we have it. Hopefully my explanations all made sense, and if not, leave a comment and let me know how I can make the post better.
Below is the full contents of my web.config.</p>
<pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;configuration&gt;
    &lt;system.webServer&gt;
        &lt;httpErrors errorMode=&quot;Custom&quot;&gt;
            &lt;remove statusCode=&quot;500&quot; subStatusCode=&quot;-1&quot; /&gt;
            &lt;remove statusCode=&quot;404&quot; subStatusCode=&quot;-1&quot; /&gt;
            &lt;error statusCode=&quot;404&quot; prefixLanguageFilePath=&quot;&quot; path=&quot;/404.html&quot; responseMode=&quot;ExecuteURL&quot; /&gt;
            &lt;error statusCode=&quot;500&quot; prefixLanguageFilePath=&quot;&quot; path=&quot;/500.html&quot; responseMode=&quot;ExecuteURL&quot; /&gt;
            &lt;error statusCode=&quot;500&quot; subStatusCode=&quot;100&quot; path=&quot;/500.html&quot; responseMode=&quot;ExecuteURL&quot; /&gt;
        &lt;/httpErrors&gt;
        &lt;rewrite&gt;
            &lt;rules&gt;
                &lt;rule name=&quot;Redirect to HTTPS&quot; stopProcessing=&quot;true&quot;&gt;
                    &lt;match url=&quot;(.*)&quot; /&gt;
                    &lt;conditions&gt;
                        &lt;add input=&quot;{REMOTE_PORT}&quot; pattern=&quot;.*&quot; /&gt;
                        &lt;add input=&quot;{HTTPS}&quot; pattern=&quot;^OFF$&quot; /&gt;
                    &lt;/conditions&gt;
                    &lt;action type=&quot;Redirect&quot; url=&quot;https://{HTTP_HOST}/{R:1}&quot; redirectType=&quot;Permanent&quot; /&gt;
                &lt;/rule&gt;
                &lt;rule name=&quot;RewriteHtml&quot;&gt;
                    &lt;match url=&quot;^(.*)$&quot; /&gt;
                    &lt;conditions logicalGrouping=&quot;MatchAll&quot;&gt;
                        &lt;add input=&quot;{REMOTE_PORT}&quot; pattern=&quot;.*&quot; /&gt;
                        &lt;add input=&quot;{REQUEST_FILENAME}&quot; matchType=&quot;IsFile&quot; negate=&quot;true&quot; /&gt;
                        &lt;add input=&quot;{REQUEST_FILENAME}&quot; matchType=&quot;IsDirectory&quot; negate=&quot;true&quot; /&gt;
                    &lt;/conditions&gt;
                    &lt;action type=&quot;Rewrite&quot; url=&quot;{R:1}.html&quot; /&gt;
                &lt;/rule&gt;
                &lt;rule name=&quot;Remove WWW&quot; stopProcessing=&quot;true&quot;&gt;
                    &lt;match url=&quot;(.*)&quot; ignoreCase=&quot;true&quot; /&gt;
                    &lt;conditions logicalGrouping=&quot;MatchAll&quot;&gt;
                        &lt;add input=&quot;{HTTP_HOST}&quot; pattern=&quot;^www\.(.+)$&quot; /&gt;
                    &lt;/conditions&gt;
                    &lt;action type=&quot;Redirect&quot; url=&quot;http://{C:1}/{R:0}&quot; appendQueryString=&quot;true&quot; redirectType=&quot;Permanent&quot; /&gt;
                &lt;/rule&gt;
            &lt;/rules&gt;
        &lt;/rewrite&gt;
        &lt;staticContent&gt;
            &lt;remove fileExtension=&quot;.mp4&quot; /&gt;
            &lt;mimeMap fileExtension=&quot;.mp4&quot; mimeType=&quot;video/mp4&quot; /&gt;
            &lt;remove fileExtension=&quot;.m4v&quot; /&gt;
            &lt;mimeMap fileExtension=&quot;.m4v&quot; mimeType=&quot;video/m4v&quot; /&gt;
            &lt;remove fileExtension=&quot;.ogg&quot; /&gt;
            &lt;mimeMap fileExtension=&quot;.ogg&quot; mimeType=&quot;video/ogg&quot; /&gt;
            &lt;remove fileExtension=&quot;.ogv&quot; /&gt;
            &lt;mimeMap fileExtension=&quot;.ogv&quot; mimeType=&quot;video/ogg&quot; /&gt;
            &lt;remove fileExtension=&quot;.webm&quot; /&gt;
            &lt;mimeMap fileExtension=&quot;.webm&quot; mimeType=&quot;video/webm&quot; /&gt;
            &lt;remove fileExtension=&quot;.oga&quot; /&gt;
            &lt;mimeMap fileExtension=&quot;.oga&quot; mimeType=&quot;audio/ogg&quot; /&gt;
            &lt;remove fileExtension=&quot;.spx&quot; /&gt;
            &lt;mimeMap fileExtension=&quot;.spx&quot; mimeType=&quot;audio/ogg&quot; /&gt;
            &lt;remove fileExtension=&quot;.svg&quot; /&gt;
            &lt;mimeMap fileExtension=&quot;.svg&quot; mimeType=&quot;image/svg+xml&quot; /&gt;
            &lt;remove fileExtension=&quot;.svgz&quot; /&gt;
            &lt;mimeMap fileExtension=&quot;.svgz&quot; mimeType=&quot;image/svg+xml&quot; /&gt;

            &lt;!-- fonts --&gt;
            &lt;remove fileExtension=&quot;.otf&quot; /&gt;
            &lt;mimeMap fileExtension=&quot;.otf&quot; mimeType=&quot;font/otf&quot; /&gt;
            &lt;remove fileExtension=&quot;.eot&quot; /&gt;
            &lt;mimeMap fileExtension=&quot;.eot&quot; mimeType=&quot;application/vnd.ms-fontobject&quot; /&gt;
            &lt;remove fileExtension=&quot;.ttf&quot; /&gt;
            &lt;mimeMap fileExtension=&quot;.ttf&quot; mimeType=&quot;application/octet-stream&quot; /&gt;
            &lt;remove fileExtension=&quot;.woff&quot; /&gt;
            &lt;mimeMap fileExtension=&quot;.woff&quot; mimeType=&quot;application/font-woff&quot; /&gt;
            &lt;remove fileExtension=&quot;.woff2&quot; /&gt;
            &lt;mimeMap fileExtension=&quot;.woff2&quot; mimeType=&quot;application/font-woff2&quot; /&gt;

            &lt;!-- feeds --&gt;
            &lt;remove fileExtension=&quot;.rss&quot; /&gt;
            &lt;mimeMap fileExtension=&quot;.rss&quot; mimeType=&quot;application/rss+xml&quot; /&gt;
            &lt;remove fileExtension=&quot;.atom&quot; /&gt;
            &lt;mimeMap fileExtension=&quot;.atom&quot; mimeType=&quot;application/atom+xml&quot; /&gt;
        &lt;/staticContent&gt;
    &lt;/system.webServer&gt;
&lt;/configuration&gt;
</code></pre>


<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'andyhansen';
    var disqus_identifier = 'web-config-for-a-static-site';
    var disqus_title = 'Web.config for a Static Site';
    var disqus_url = 'http://andyhansen.co.nz/posts/web-config-for-a-static-site';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                                </div>
                        </div>
                </div>
                
                <hr>
                
                <!-- Footer -->
                <footer>
                        <div class="container">
        <div class="row">
                <div class="col-md-12 text-center">
                    <p class="copyright text-muted">
                        Copyright © 2018
                        <br />
                            <a href="/feed.rss"><i class="fa fa-rss"></i> RSS Feed</a>
                        |
                            <a href="/feed.atom"><i class="fa fa-rss"></i> Atom Feed</a>
                        <br />
                        <strong><a href="https://wyam.io">Generated by Wyam</a></strong>
                    </p>
                </div>
        </div>
</div>

                </footer> 

                <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-91125210-1', 'auto');
  ga('send', 'pageview');
</script>
<script src="/assets/js/readingTime.js"></script>
<script src="/assets/js/wordCount.js"></script>
                <script>hljs.initHighlightingOnLoad();</script>


                <script>
                        BackgroundCheck.init({
                                targets: '.intro-header,.navbar',
                                images: '.intro-header'
                        });
                </script>
        </body>
</html>

